!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.r(t),n.d(t,"default",(function(){return o}));var i=function e(t,n,r){a(this,e),this.sheetId=t,this.sheetName=n,this.sheetRange=r},o=function e(){a(this,e)};r(o,"ActiveCategories",["Food Pantry","Meal Sites","School Meal Pickup"]),r(o,"GeocodingServiceUri","https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),r(o,"MapBoxToken","pk.eyJ1Ijoiam9uamFuZWxsZSIsImEiOiJjazhxbXg0YmswNW5kM2RvNGNjb2hiN2poIn0.LiFKVlPQe_vqyqjjIw0DIw"),r(o,"PantryServiceBaseUri","https://sheets-api.azurewebsites.net/api/ReadSheet.php"),r(o,"PantryDataQueryConfig",new i("1wwdNhR7lXu-LnIPb0wl30Vydx0ql_Kp_MGBy5frsVfg","Agency Data","A:M")),r(o,"SchoolPickupQueryConfig",new i("135l8GGHQ2DSqvTI28_Pgu3HjA2u8fZNqsbPX3_xWbbk","School Pickup","A:S")),r(o,"CityOptionsQueryConfig",new i("135l8GGHQ2DSqvTI28_Pgu3HjA2u8fZNqsbPX3_xWbbk","FormOptions","A:A"))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"default",(function(){return i}));var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"getPath",value:function(e){return"map-markers/".concat(e)}}],(n=null)&&r(t.prototype,n),a&&r(t,a),e}();a(i,"AccessDenied","accessdenied.png"),a(i,"Aed","aed-2.png"),a(i,"Airport","airport.png"),a(i,"Ambulance","ambulance.png"),a(i,"Apple","apple.png"),a(i,"View","beautifulview.png"),a(i,"Binoculars","binoculars.png"),a(i,"Bread","bread.png"),a(i,"Burger","burger.png"),a(i,"Bus","bus.png"),a(i,"Bus2","bustour.png"),a(i,"Car","car.png"),a(i,"Caution","caution.png"),a(i,"Chart","chart-2.png"),a(i,"Cinema","cinema.png"),a(i,"Coffee","coffee.png"),a(i,"Computer","computers.png"),a(i,"Contract","contact.png"),a(i,"Cycling","cycling.png"),a(i,"Dancing","dancinghall.png"),a(i,"Wheelchair","disability.png"),a(i,"Drink","drink.png"),a(i,"Restaurant","restaurant.png"),a(i,"Farmstand","farmstand.png"),a(i,"Motel","motel-2.png"),a(i,"Home","home-2.png"),a(i,"Star","star-3.png"),a(i,"DayCare","daycare.png"),a(i,"FastFood","fastfood.png"),a(i,"Farm","farm-2.png"),a(i,"Grocery","grocery.png"),a(i,"Utensils","eating-utensils.png")},function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,l=e[Symbol.iterator]();!(r=(o=l.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",(function(){return o}));var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,a=[{key:"getQueryParams",value:function(){var e={};return location.search&&location.search.substr(1).split("&").forEach((function(t){var n=r(t.split("="),2),a=n[0],i=n[1];i=i&&decodeURIComponent(i),(e[a]=e[a]||[]).push(i)})),e}},{key:"isNullOrEmpty",value:function(e){return null==e||("String"===e.constructor.name?0===e.trim().length:"Array"===e.constructor.name&&0===e.length)}},{key:"telFormat",value:function(e){e.replace(/\D/g,"").replace(/^1?/,"+1")}}],(n=null)&&i(t.prototype,n),a&&i(t,a),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r,a,i,o=function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.value=n,this.filterType=r};i={Single:0,Multi:1,GeoPoint:2},(a="FilterType")in(r=o)?Object.defineProperty(r,a,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[a]=i},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(1);function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i,o,l,s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n===e.ResourceType.Pantry?this._pantryMapping(t):n===e.ResourceType.School&&this._schoolPickupMapping(t),this._setIcon()}var t,n,i;return t=e,(n=[{key:"_pantryMapping",value:function(e){this.Id=this._generateId(),this.Category=e.Category,this.Name=e.Name,this.County=e.County,this.Town=e.Town,this.Address=e.Address,this.Phone=e.Phone,this.Email=null,this.LastUpdated=e.DateUpdated,this.HoursOfOperation=e.HoursOfOperation,this.OperationalNotes=e.OperationalNotes,this.WebLink=e.WebLink,this.WebLink2=e.AdditionalWebLink,this.Latitude=parseFloat(e.Latitude),this.Longitude=parseFloat(e.Longitude),this.SpecialHoursOfOperation=null,this.SpecialNotes=null,this.IsActive=!0}},{key:"_schoolPickupMapping",value:function(e){this.Id=this._generateId(),this.Category=e.Category,this.Name=e.ProviderName,this.County=e.County,this.Town=null,this.Address=e.Address,this.Phone=e.Phone,this.Email=e.Email,this.LastUpdated=null,this.HoursOfOperation=e.Hours,this.OperationalNotes=e.OperationalNotes,this.WebLink=e.Website1,this.WebLink2=e.Website2,this.Latitude=parseFloat(e.Latitude),this.Longitude=parseFloat(e.Longitude),this.SpecialHoursOfOperation=null,this.SpecialNotes=null,this.IsActive=!0}},{key:"_setIcon",value:function(){"Meal Sites"==this.Category?this.IconUrl=r.default.getPath(r.default.Restaurant):"Food Pantry"==this.Category?this.IconUrl=r.default.getPath(r.default.Grocery):"School Meal Pickup"==this.Category?this.IconUrl=r.default.getPath(r.default.Utensils):this.IconUrl=r.default.getPath(r.default.Star)}},{key:"_generateId",value:function(){return"xxxxxxxxxxxx".replace(/[x]/g,(function(e){return(16*Math.random()|0).toString(16)}))}}])&&a(t.prototype,n),i&&a(t,i),e}();l={Pantry:0,School:1},(o="ResourceType")in(i=s)?Object.defineProperty(i,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):i[o]=l},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",(function(){return a}));var a=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.latitude=t,this.longitude=n}var t,n,a;return t=e,(n=[{key:"distanceTo",value:function(e){var t=function(e){return e*Math.PI/180},n=t(e.latitude-this.latitude),r=t(e.longitude-this.longitude),a=Math.sin(n/2)*Math.sin(n/2)+Math.cos(t(this.latitude))*Math.cos(t(e.latitude))*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))*6371}}])&&r(t.prototype,n),a&&r(t,a),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(4),a=n(0);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.foodResourceUrl="".concat(a.default.PantryServiceBaseUri,"?sheetId=").concat(a.default.PantryDataQueryConfig.sheetId,"&sheetName=").concat(a.default.PantryDataQueryConfig.sheetName,"&sheetRange=").concat(a.default.PantryDataQueryConfig.sheetRange),this.schoolPickupUrl="".concat(a.default.PantryServiceBaseUri,"?sheetId=").concat(a.default.SchoolPickupQueryConfig.sheetId,"&sheetName=").concat(a.default.SchoolPickupQueryConfig.sheetName,"&sheetRange=").concat(a.default.SchoolPickupQueryConfig.sheetRange),this.cityOptionsUrl="".concat(a.default.PantryServiceBaseUri,"?sheetId=").concat(a.default.CityOptionsQueryConfig.sheetId,"&sheetName=").concat(a.default.CityOptionsQueryConfig.sheetName,"&sheetRange=").concat(a.default.CityOptionsQueryConfig.sheetRange)}var t,n,o;return t=e,(n=[{key:"getCities",value:function(){var e=$.Deferred();return $.get(this.cityOptionsUrl).done((function(t,n){var r=JSON.parse(t).map((function(e){return e.City}));e.resolve(r)})).fail((function(t){console.error(t),e.reject()})),e.promise()}},{key:"getPantries",value:function(){var e=$.Deferred();return $.get(this.foodResourceUrl).done((function(t,n){var a=JSON.parse(t).map((function(e){return new r.default(e,r.default.ResourceType.Pantry)}));e.resolve(a)})).fail((function(t){console.error(t),e.reject()})),e.promise()}},{key:"getSchoolPickups",value:function(){var e=$.Deferred();return $.get(this.schoolPickupUrl).done((function(t,n){var a=JSON.parse(t).map((function(e){return new r.default(e,r.default.ResourceType.School)}));e.resolve(a)})).fail((function(t){console.error(t),e.reject()})),e.promise()}}])&&i(t.prototype,n),o&&i(t,o),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(6),a=n(0);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._townZipSelectId="town-zip-input",this._categorySelectId="category-select",this._setCategorySelectOptions(a.default.ActiveCategories),this._setMobileNavHandler(),this._setFormSubmitHandler(),this._dataService=new r.default,this._setSelect2Inputs(),$("#radius-select").val(10)}var t,n,o;return t=e,(n=[{key:"_setFormSubmitHandler",value:function(){var e=this;$("#search-form").submit((function(t){t.preventDefault(),window.location.href="map.html".concat(e._buildQueryFilter())}))}},{key:"_setMobileNavHandler",value:function(){var e=$(".navbar-collapse");e.on("click","a:not([data-toggle])",null,(function(){return e.collapse("hide")})),$("#page-content").click((function(){return e.collapse("hide")}))}},{key:"_setCategorySelectOptions",value:function(e){var t=this;$("#".concat(this._categorySelectId)).empty(),e.forEach((function(e){return $("#".concat(t._categorySelectId)).append('<option value="'.concat(e,'">').concat(e,"</option>"))})),$("#".concat(this._categorySelectId)).select2({placeholder:"Select categories",minimumResultsForSearch:-1}),$("#".concat(this._categorySelectId)).on("select2:opening select2:closing",(function(e){$("#"+e.target.id).parent().find(".select2-search__field").prop("disabled",!0)})),$("#".concat(this._categorySelectId)).val(e),$("#".concat(this._categorySelectId)).trigger("change")}},{key:"_buildQueryFilter",value:function(){var e=$("#".concat(this._categorySelectId)).val(),t=$("#".concat(this._townZipSelectId)).val(),n=$("#radius-select").val();return"?"+e.map((function(e){return"category=".concat(e)})).join("&")+"&radius=".concat(n,"&zipCode=").concat(t)}},{key:"_setSelect2Inputs",value:function(){var e=this;$("#".concat(this._townZipSelectId)).select2({placeholder:"Enter town or zip code",allowClear:!0,tags:!0,dropdownPosition:"below"}),this._dataService.getCities().then((function(t){$("#".concat(e._townZipSelectId)).empty(),$("#".concat(e._townZipSelectId)).append("<option selected value=''></option>"),t.forEach((function(t){return $("#".concat(e._townZipSelectId)).append('<option value="'.concat(t,'">').concat(t,"</option>"))}))}))}}])&&i(t.prototype,n),o&&i(t,o),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return l}));var r=n(5),a=(n(1),n(0)),i=n(11);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._mapId=t,this._mapboxToken=a.default.MapBoxToken,this.markers={}}var t,n,l;return t=e,(n=[{key:"init",value:function(){var e=this,t=$.Deferred();return(new i.default).getLocation().then((function(n){e.defaultCenter=n?new r.default(n.latitude,n.longitude):new r.default(45.1690993,-69.2568189),e.defaultZoom=n?12:7,e.map=L.map(e._mapId,{center:[e.defaultCenter.latitude,e.defaultCenter.longitude],zoom:e.defaultZoom,layers:e._getBasemaps()}),e.map.zoomControl.setPosition("topleft"),e.layerGroup=L.layerGroup().addTo(e.map),L.control.layers(e._baseMaps,{}).addTo(e.map),t.resolve()})),t.promise()}},{key:"setPosition",value:function(e,t){this.map.setView([e.latitude,e.longitude],t)}},{key:"zoomDefault",value:function(){this.setPosition(this.defaultCenter,this.defaultZoom)}},{key:"addMarker",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=n?{icon:n}:{},a=L.marker([e.latitude,e.longitude],r).addTo(this.layerGroup);this.markers[t]=a}},{key:"addMarkerPopup",value:function(e,t){this.markers[e].bindPopup(t)}},{key:"clearMarkers",value:function(){this.layerGroup.clearLayers(),this.markers={}}},{key:"addLegend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bottomright",n=L.control({position:t});n.onAdd=function(t){return e},n.addTo(this.map)}},{key:"fitMarkerBounds",value:function(){var e=Object.keys(this.markers).length;if(e>1){var t=new L.featureGroup(Object.values(this.markers));this.map.fitBounds(t.getBounds())}else if(1===e){var n=L.latLngBounds([Object.values(this.markers)[0].getLatLng()]);this.map.fitBounds(n)}}},{key:"_getBasemaps",value:function(){return this._baseMaps={OpenStreetMap:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),Dark:L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+this._mapboxToken,{id:"mapbox/dark-v10",attribution:"&copy; Mapbox",tileSize:512,zoomOffset:-1}),Light:L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+this._mapboxToken,{id:"mapbox/light-v10",tileSize:512,zoomOffset:-1}),Default:L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+this._mapboxToken,{id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1})},Object.values(this._baseMaps)}}])&&o(t.prototype,n),l&&o(t,l),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return h}));var r=n(3),a=n(6),i=n(5),o=(n(8),n(13)),l=n(2),s=n(1);function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=d(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw i}}}}function u(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),$("#alert-bar").alert(),this.cityOptions=[],this.map=t,this._data=[],this._sideBarData=[],this._filteredData=[],this._filters=[],this._dataService=new a.default,this._setLegend(),this._setSidebarScrollListener(),new o.default(this).init()}var t,n,d;return t=e,(n=[{key:"start",value:function(e){var t=this;this._dataService.getCities().then((function(n){t.cityOptions=n,t._getData().then((function(){e()}))}))}},{key:"setFilter",value:function(e){l.default.isNullOrEmpty(e)||(this._filters=this._filters.filter((function(t){return t.field!==e.field})),this._filters.push(e),this.refresh())}},{key:"refresh",value:function(){var e=this;this._filteredData=this._data,this._filters.filter((function(e){return!l.default.isNullOrEmpty(e.value)})).forEach((function(t){if(t.filterType==r.default.FilterType.Single)e._filteredData=e._filteredData.filter((function(e){return e[t.field].indexOf(t.value)>=0}));else if(t.filterType==r.default.FilterType.Multi)e._filteredData=e._filteredData.filter((function(e){return t.value.indexOf(e[t.field])>=0}));else if(t.filterType==r.default.FilterType.GeoPoint){var n=1.6093*parseInt(t.value.radius);e._filteredData=e._filteredData.filter((function(e){return new i.default(e.Latitude,e.Longitude).distanceTo(t.value.geoPoint)<=n}))}else console.error("Invalid filter: ",t)})),this._refreshMarkersAndSidebar()}},{key:"_refreshMarkersAndSidebar",value:function(){this.map.clearMarkers(),this._buildMapMarkers(this._filteredData),this._sideBarData=this._filteredData.slice(0,20),this._buildSidebarListing(this._sideBarData),this._setResultCount(),this.map.fitMarkerBounds()}},{key:"_getData",value:function(){var e=this,t=$.Deferred();return this._dataService.getPantries().then((function(n){e._data=n.filter((function(e){return e.IsActive})),e._dataService.getSchoolPickups().then((function(n){e._data=[].concat(u(e._data),u(n)),t.resolve()}),(function(e){return t.reject()}))}),(function(e){return t.reject()})),t.promise()}},{key:"_setLegend",value:function(){var e=L.DomUtil.create("div","legend");e.innerHTML+='<div style="background-color:white;>',e.innerHTML+="<img src=".concat(s.default.getPath(s.default.Grocery),' width="24" height="24" alt="Food Pantry"/> &ndash; Food Pantry <br>'),e.innerHTML+="<img src=".concat(s.default.getPath(s.default.Restaurant),' width="24" height="24" alt="Meal Site"/> &ndash; Meal Site <br>'),e.innerHTML+="<img src=".concat(s.default.getPath(s.default.Utensils),' width="24" height="24" alt="School Meal Pickup Site"/> &ndash; School Meal Pickup<br>'),e.innerHTML+="</div>",this.map.addLegend(e)}},{key:"_setResultCount",value:function(){this._filteredData.length>0?($(".zero-results").addClass("hidden"),$(".result-count-container").removeClass("hidden"),$(".result-count").html(this._filteredData.length)):($(".result-count-container").addClass("hidden"),$(".zero-results").removeClass("hidden"))}},{key:"_setSidebarScrollListener",value:function(){var e=this;document.getElementById("map-results-list").onscroll=function(t){var n=parseInt(t.target.scrollTop/150),r=Math.min(e._filteredData.length,n+20);e._sideBarData=e._filteredData.slice(0,r),e._buildSidebarListing(e._sideBarData)}}},{key:"_buildMapMarkers",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.Latitude&&r.Longitude&&(this.map.markers[r.Id]||this.map.addMarker(new i.default(r.Latitude,r.Longitude),r.Id,this._getIcon(r)),this.map.addMarkerPopup(r.Id,this._getMarkerPopupHtml(r)))}}catch(e){n.e(e)}finally{n.f()}}},{key:"_getIcon",value:function(e){return e.IconUrl?L.icon({iconUrl:e.IconUrl,iconSize:[32,37],iconAnchor:[22,36],popupAnchor:[-3,-36]}):null}},{key:"_buildSidebarListing",value:function(e){var t=this,n=document.getElementById("map-results-list"),r=document.getElementById("list-result-template").innerHTML,a=Handlebars.compile(r);n.innerHTML=a(e),this._setSidebarHeader();var o=$("#sidebar-heading").height()+8;$("#map-result-spacer").css("height",o+"px"),$("#map-results-list").css("height",$("#map-list-wrapper").height()-o-12+"px"),$(".result-list-item-container").on("click",(function(e){if(window.innerWidth>768){var n="";try{var r=e.currentTarget.getAttribute("id");n=r.split("-")[1];var a=t._filteredData.find((function(e){return e.Id===n}));a&&($(".result-list-item-container").removeClass("background-selected"),$("#".concat(r)).addClass("background-selected"),t.map.setPosition(new i.default(a.Latitude,a.Longitude),14),t.map.markers[a.Id].openPopup())}catch(e){console.error("Could not find resource Id on target element.",e)}}}))}},{key:"_setSidebarHeader",value:function(){var e=this,t=['<div class="small"><strong>Current filters</strong></div>'];if(this._appliedFilterCount()>0){var n,a=c(this._filters);try{var i=function(){var e=n.value;e.filterType!=r.default.FilterType.Single||l.default.isNullOrEmpty(e.value)?e.filterType!=r.default.FilterType.Multi||l.default.isNullOrEmpty(e.value)?e.filterType==r.default.FilterType.GeoPoint&&t.push('<span class="badge badge-info filter-badge">'.concat(e.value.zipCode," (").concat(e.value.radius,'mi) <span class="remove-badge material-icons" title="remove filter" value="Radius">clear</span></span>')):e.value.forEach((function(n){return t.push('<span class="badge badge-info filter-badge">'.concat(e.field,": ").concat(n,' <span class="remove-badge material-icons" title="remove filter" value="').concat(e.field,":").concat(n,'">clear</span></span>'))})):t.push('<span class="badge badge-info filter-badge">'.concat(e.field,": ").concat(e.value,' <span class="remove-badge material-icons" title="remove filter" value="').concat(e.field,":").concat(e.value,'">clear</span></span>'))};for(a.s();!(n=a.n()).done;)i()}catch(e){a.e(e)}finally{a.f()}}else t.push("<span class='color-dark'><small>No filters selected.</small></span>");$("#sidebar-heading").html(t.join("")),$(".remove-badge").on("click",(function(t){var n=t.target.getAttribute("value").split(":");if("Category"===n[0]){var r=n[1],a=e._filters.find((function(e){return"Category"===e.field}));a&&(a.value=a.value.filter((function(e){return e!==r})),$("#category-select").val(a.value).trigger("change.select2"),e.refresh())}else"Radius"===n[0]&&e._filters.find((function(e){return"Radius"===e.field}))&&(e._filters=e._filters.filter((function(e){return"Radius"!==e.field})),$("#town-zip-input").val(null).trigger("change.select2"),e.refresh())}))}},{key:"_getMarkerPopupHtml",value:function(e){var t=['<span style="font-size:1.1rem">'.concat(e.Name,"</span><br>"),'<hr style="margin-top: 0; margin-bottom: 4px;">',"<span><b>Category: </b>".concat(e.Category,"</span><br>")];return l.default.isNullOrEmpty(e.Phone)||t.push('<span><b>Phone: </b><a href="tel:'.concat(l.default.telFormat(e.Phone),'">').concat(e.Phone,"</a></span><br>")),l.default.isNullOrEmpty(e.Email)||t.push('<span><b>Email: </b><a href="mailto:'.concat(e.Email,'">').concat(e.Email,"</a></span><br>")),l.default.isNullOrEmpty(e.Address)||t.push("<span><b>Address: </b>".concat(e.Address,"</span><br>")),l.default.isNullOrEmpty(e.SpecialHoursOfOperation)?l.default.isNullOrEmpty(e.HoursOfOperation)||t.push("<span><b>Hours: </b>".concat(e.HoursOfOperation,"</span><br>")):t.push("<span><b>Covid-19 Hours: </b>".concat(e.SpecialHoursOfOperation,"</span><br>")),l.default.isNullOrEmpty(e.SpecialNotes)||t.push("<span><b>Covid-19 Notes: </b>".concat(e.SpecialNotes,"</span><br>")),l.default.isNullOrEmpty(e.OperationalNotes)||t.push("<span><b>Notes: </b>".concat(e.OperationalNotes,"</span><br>")),l.default.isNullOrEmpty(e.WebLink)||t.push("<span><b>Website: </b><a href='".concat(e.WebLink,"' target='_blank'>").concat(e.WebLink,"</a></span><br>")),l.default.isNullOrEmpty(e.WebLink2)||t.push("<span><b>Website 2: </b><a href='".concat(e.WebLink2,"' target='_blank'>").concat(e.WebLink2,"</a></span><br>")),t.join("")}},{key:"_appliedFilterCount",value:function(){var e,t=0,n=c(this._filters);try{for(n.s();!(e=n.n()).done;){var r=e.value;"Category"==r.field?t+=r.value.length:t+=1}}catch(e){n.e(e)}finally{n.f()}return t}}])&&p(t.prototype,n),d&&p(t,d),e}()},function(e,t,n){"use strict";n.r(t);var r=n(7);$((function(){return new r.default}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"default",(function(){return a}));var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,a;return t=e,(n=[{key:"getLocation",value:function(){var e=$.Deferred();return navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){return e.resolve(t.coords)}),(function(t){return e.resolve(null)})):e.resolve(null),e.promise()}}])&&r(t.prototype,n),a&&r(t,a),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(0),a=n(5);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._geocodingService=r.default.GeocodingServiceUri}var t,n,o;return t=e,(n=[{key:"geocodeSingleLine",value:function(e){var t=$.Deferred();if(e&&e.length>0){var n="".concat(this._geocodingService,"/findAddressCandidates?f=json&SingleLine=").concat(e);$.get(n).done((function(e,n){e.candidates&&e.candidates.length>0?t.resolve(new a.default(e.candidates[0].location.y,e.candidates[0].location.x)):t.reject()}))}else t.reject();return t.promise()}},{key:"reverseGeocode",value:function(e){var t=$.Deferred();if(e.latitude&&e.longitude){var n="".concat(this._geocodingService,"/reverseGeocode?location=").concat(e.longitude,",").concat(e.latitude,"&forStorage=false&f=json&featureTypes=PointAddress");$.get(n).done((function(e,n){e.address&&e.address.City&&e.address.Subregion?t.resolve([e.address.City,e.address.Subregion.split(" ")[0],e.address.Postal]):t.reject()}))}else t.reject();return t.promise()}}])&&i(t.prototype,n),o&&i(t,o),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s}));var r=n(0),a=n(3),i=n(12),o=(n(9),n(2));function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mapController=t,this._categorySelectId="category-select",this._radiusSelectId="radius-select",this._townZipId="town-zip-input",this._lastWasMobile=null,this._prevWidth=null}var t,n,s;return t=e,(n=[{key:"init",value:function(){this._prevWidth=window.innerHeight,this._setNavbar(),this._resetInputHandlers(),this._setResizeHandler(),this._initMapController()}},{key:"_initMapController",value:function(){var e=this;$("#loadingModal").modal("show"),this.mapController.start((function(){e.setFilterOptions();var t=o.default.getQueryParams();if(t.zipCode&&t.zipCode.length>0){if($("#".concat(e._townZipId)).find("option[value='"+t.zipCode+"']").length)$("#".concat(e._townZipId)).val(t.zipCode).trigger("change.select2");else{var n=new Option(t.zipCode,t.zipCode,!0,!0);$("#".concat(e._townZipId)).append(n).trigger("change.select2")}t.radius&&t.radius.length>0?$("#".concat(e._radiusSelectId)).val(t.radius):$("#".concat(e._radiusSelectId)).val(10),e._setRadiusFilter().always((function(){return e._initCategoryFilter(t,!0)}))}else e._initCategoryFilter(t,!1)}))}},{key:"_initCategoryFilter",value:function(e,t){e.category&&e.category.length>0&&($("#".concat(this._categorySelectId)).val(e.category).trigger("change.select2"),t=!0),t||($("#".concat(this._radiusSelectId)).val(10),$("#".concat(this._categorySelectId)).val(r.default.ActiveCategories).trigger("change.select2")),this.setCategoryFilter($("#".concat(this._categorySelectId)).val()),this.setFilterOptions(),setTimeout((function(){return $("#loadingModal").modal("hide")}),500)}},{key:"setFilterOptions",value:function(){var e=this.mapController.cityOptions.sort();this._setSelectOptions(this._townZipId,e);var t=r.default.ActiveCategories.sort();this._setSelectOptions(this._categorySelectId,t),this._resetSelected()}},{key:"setCategoryFilter",value:function(e){this.mapController.setFilter(new a.default("Category",e,a.default.FilterType.Multi))}},{key:"getCategoryFilter",value:function(){var e=this.mapController._filters.find((function(e){return"Category"===e.field}));return e?e.value:[]}},{key:"clearCategoryFiltertegoryFilter",value:function(e){var t=this.mapController._filters.find((function(e){return"Category"===e.field}));t&&(t.value=t.value.filter((function(t){return t!==e})),$("#".concat(this._categorySelectId)).val(t.value).trigger("change.select2"),this.mapController.refresh())}},{key:"setRadiusFilter",value:function(e,t,n){this.mapController.setFilter(new a.default("Radius",{zipCode:e,geoPoint:t,radius:n},a.default.FilterType.GeoPoint))}},{key:"getRadiusFilter",value:function(){var e=this.mapController._filters.find((function(e){return"Radius"===e.field}));return e?e.value:{zipCode:null,geoPoint:null,radius:10}}},{key:"clearRadiusFilter",value:function(){this.mapController._filters.find((function(e){return"Radius"===e.field}))&&(this.mapController._filters=this.mapController._filters.filter((function(e){return"Radius"!==e.field})),$("#".concat(this._townZipId)).val(null).trigger("change.select2"),this.mapController.refresh())}},{key:"_setSelectOptions",value:function(e,t){$("#".concat(e)).empty(),$("#".concat(e)).append("<option selected value=''></option>"),t.forEach((function(t){return $("#".concat(e)).append('<option value="'.concat(t,'">').concat(t,"</option>"))}))}},{key:"_setSelect2Inputs",value:function(){$("#".concat(this._townZipId)).select2({placeholder:"Enter town or zip code",allowClear:!0,tags:!0,dropdownPosition:"below"}),$("#".concat(this._categorySelectId)).select2({placeholder:"Filter categories",minimumResultsForSearch:-1}),$("#".concat(this._categorySelectId)).on("select2:opening select2:closing",(function(e){$("#"+e.target.id).parent().find(".select2-search__field").prop("disabled",!0)}))}},{key:"_setResizeHandler",value:function(){var e=this;window.onresize=function(){Math.abs(window.innerWidth-e._prevWidth)>15&&(e._setNavbar(),e._resetInputHandlers()),e._prevWidth=window.innerWidth}}},{key:"_setNavbar",value:function(){var e=window.innerWidth<768;if(null===this._lastWasMobile||e!==this._lastWasMobile){var t=e?"nav-mobile":"nav-desktop",n="nav-mobile"===t?"nav-desktop":"nav-mobile",r=document.getElementById("navbar-template").innerHTML,a=Handlebars.compile(r);document.getElementById(t).innerHTML=a(),$("#".concat(n)).empty(),this._setSidebarHandlers()}setTimeout((function(){if(e){var t=$("#top-card").height(),n=$("#nav-mobile").height();$("#main-map").css("min-height","".concat(window.innerHeight-t-n-20,"px"))}else $("#main-map").css("min-height","70vh")}),300),this._lastWasMobile=e}},{key:"_resetInputHandlers",value:function(){this._setHomeButtonHandler(),this._setFilters(),this._setSelect2Inputs()}},{key:"_setHomeButtonHandler",value:function(){$("#home-button").click((function(e){e.preventDefault(),confirm("Return to homepage?")&&(window.location.href="index.html")}))}},{key:"_setSidebarHandlers",value:function(){$("#list-toggle").click((function(e){e.preventDefault(),$(".sidebar-toggleable").toggleClass("toggled"),e.stopPropagation()})),$("#filters-toggle").click((function(e){e.preventDefault(),$("#filters-mobile").toggleClass("toggled"),e.stopPropagation()})),$(".main-content, #sidebar-wrapper").click((function(e){window.innerWidth<768&&!$("#filters-mobile").hasClass("toggled")&&$("#filters-mobile").toggleClass("toggled")}))}},{key:"_setFilters",value:function(){var e=this,t=window.innerWidth<768?"filters-mobile":"filters-desktop",n="filters-mobile"===t?"filters-desktop":"filters-mobile",r=document.getElementById("filters-template").innerHTML,a=Handlebars.compile(r);document.getElementById(t).innerHTML=a(),$("#".concat(this._categorySelectId)).change((function(t){e.setCategoryFilter($("#".concat(e._categorySelectId)).val())})),$("#zip-search-form").submit((function(t){t.preventDefault(),e._setRadiusFilter()})),this.setFilterOptions(),$("#".concat(n)).empty()}},{key:"_setRadiusFilter",value:function(){var e=this,t=$.Deferred(),n=$("#".concat(this._townZipId)).val(),r=$("#".concat(this._radiusSelectId)).val();if(n&&r&&n.length>0&&r.length>0){var a=n;n.toString().trim().match(/^([0-9]{5})(-[0-9]{4})?$/)||(a+=", ME"),(new i.default).geocodeSingleLine(a).then((function(a){e.setRadiusFilter(n,a,r),e._resetSelected(),t.resolve()}),(function(e){return t.reject()}))}else t.resolve();return t.promise()}},{key:"_resetSelected",value:function(){$("#".concat(this._categorySelectId)).val(this.getCategoryFilter()),$("#".concat(this._radiusSelectId)).val(this.getRadiusFilter().radius),$("#".concat(this._townZipId)).val(this.getRadiusFilter().zipCode)}}])&&l(t.prototype,n),s&&l(t,s),e}()},function(e,t,n){n(8),n(11),n(3),n(12),n(5),n(1),n(2),n(15),n(16),n(10),n(7),n(4),n(17),n(13),n(9),n(6),e.exports=n(0)},function(e,t){Handlebars.registerHelper("arr_empty",(function(e,t){return null==e||0===e.length?t.fn(this):t.inverse(this)})),Handlebars.registerHelper("tel",(function(e){return e.replace(/\D/g,"").replace(/^1?/,"+1")}))},function(e,t){!function(e){var t=e.fn.select2.amd.require("select2/defaults");e.extend(t.defaults,{dropdownPosition:"auto"});var n=e.fn.select2.amd.require("select2/dropdown/attachBody");n.prototype._positionDropdown;n.prototype._positionDropdown=function(){var t=e(window),n=this.$dropdown.hasClass("select2-dropdown--above"),r=this.$dropdown.hasClass("select2-dropdown--below"),a=null,i=this.$container.offset();i.bottom=i.top+this.$container.outerHeight(!1);var o={height:this.$container.outerHeight(!1)};o.top=i.top,o.bottom=i.top+o.height;var l=this.$dropdown.outerHeight(!1),s=t.scrollTop(),c=t.scrollTop()+t.height(),u=s<i.top-l,d=c>i.bottom+l,f={left:i.left,top:o.bottom},p=this.$dropdownParent;"static"===p.css("position")&&(p=p.offsetParent());var h=p.offset();f.top-=h.top,f.left-=h.left;var g=this.options.get("dropdownPosition");"above"===g||"below"===g?a=g:(n||r||(a="below"),d||!u||n?!u&&d&&n&&(a="below"):a="above"),("above"==a||n&&"below"!==a)&&(f.top=o.top-h.top-l),null!=a&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+a),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+a)),this.$dropdownContainer.css(f)}}(window.jQuery)},function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(9);$((function(){var e=new r.default("main-map");e.init().then((function(){return new a.default(e)}))}))}]);